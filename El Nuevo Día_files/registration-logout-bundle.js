(window.webpackJsonp_spotim_registration=window.webpackJsonp_spotim_registration||[]).push([[32],{25:function(t,e,r){"use strict";r.d(e,"f",(function(){return c})),r.d(e,"g",(function(){return a})),r.d(e,"e",(function(){return i})),r.d(e,"h",(function(){return u})),r.d(e,"d",(function(){return s})),r.d(e,"c",(function(){return d})),r.d(e,"b",(function(){return f})),r.d(e,"a",(function(){return p}));var n=r(40),o=r.n(n);function c(){return document.body.clientWidth<480}var a=c(),i="object"===("undefined"==typeof window?"undefined":o()(window))&&/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),u=function(t){return t.replace(/-./g,(function(t){return t.toUpperCase()[1]}))};function s(t){switch(t){case"fields.email.errors.invalid":return 1;default:return}}var d=function(t){return btoa(unescape(encodeURIComponent(t)))},f=function(t){return decodeURIComponent(escape(window.atob(t)))},p=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}},26:function(t,e,r){"use strict";var n=r(20),o=r.n(n),c=r(21),a=r.n(c),i=r(12),u=r(15),s=r.n(u),d=r(2),f=r(22),p=r(1),l=r(3),g=r(25),O=function(){var t=a()(o.a.mark((function t(e){var r,n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!p.i&&!p.l){t.next=7;break}return t.next=4,s()("v1.0.0/authentication/current-user",{method:"POST",headers:{"x-spot-id":p.r,"x-real-user-mode":"true"}});case 4:r=t.sent,t.next=10;break;case 7:return t.next=9,Object(f.default)("me/login",{method:"POST",body:JSON.stringify({spot_id:p.r})});case 9:r=t.sent;case 10:return(n=Object(i.parseUser)(r)).isRegistered&&(Object(d.dispatchSpotimEvent)("spot-im-post-login",{currentUser:{email:n.email||"",username:n.username||""}}),e&&(c=Object(g.c)(JSON.stringify({userId:n.id,displayName:n.displayName,imageId:n.imageId,social:e})),localStorage.setItem(p.a,c))),t.abrupt("return",n);case 15:throw t.prev=15,t.t0=t.catch(0),l.a.error("login",t.t0),new Error("Login failed due to with error: ".concat(t.t0));case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}();e.a=O},29:function(t,e,r){"use strict";var n=r(20),o=r.n(n),c=r(21),a=r.n(c),i=r(12),u=r.n(i),s=r(22),d=r(1);e.a=a()(o.a.mark((function t(){var e,r,n,c,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.getAsyncToken();case 2:return e=t.sent,r=e.networkId,t.next=6,Object(s.default)("me/network-token/".concat(r),{method:"POST",body:JSON.stringify({spot_id:d.r})});case 6:return n=t.sent,c=n.network_id,a=n.token,u.a.setToken(a,c),t.abrupt("return",{token:a});case 11:case"end":return t.stop()}}),t)})))},31:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(2),o=null;function c(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=console).log.apply(e,["%cSpot.IM ".concat(t),"background: #307fe2; color: white;"].concat(n))}function a(t){var e=function(){try{if(null===o){var t=new URLSearchParams(Object(n.getLocation)().search);if((o=t.get("SPOTIM_DEBUG_API".toLowerCase()))||(o=window.SPOTIM_DEBUG_API),!o)try{o=window.localStorage.getItem("SPOTIM_DEBUG_API")}catch(t){}o||(o=""),o=o.split(",").map((function(t){return t.toLowerCase()}))}return o}catch(t){return[]}}();return e.indexOf("*")>-1||e.indexOf(t.toLowerCase())>-1?c.bind(null,t):function(){}}},34:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"b",(function(){return u}));var n=r(3),o=r(31),c=Object(o.a)("SSO"),a=function(t){var e;try{e=localStorage.getItem("OWֹֹ_EXTERNAL_USER_ID")||""}catch(t){var r="SSO - cannot get ".concat("OWֹֹ_EXTERNAL_USER_ID"," from local storage: ").concat(t);c(r),n.a.error("startSSO",r)}return String(t)!==String(e)},i=function(t){try{localStorage.setItem("OWֹֹ_EXTERNAL_USER_ID",t)}catch(t){var e="SSO - cannot set ".concat("OWֹֹ_EXTERNAL_USER_ID"," in local storage: ").concat(t);c(e),n.a.error("startSSO",e)}},u=function(){try{localStorage.removeItem("OWֹֹ_EXTERNAL_USER_ID")}catch(e){var t="SSO - cannot set ".concat("OWֹֹ_EXTERNAL_USER_ID"," in local storage: ").concat(e);c(t),n.a.error("startSSO",t)}}},51:function(t,e,r){"use strict";r.r(e);var n=r(20),o=r.n(n),c=r(5),a=r.n(c),i=r(21),u=r.n(i),s=r(12),d=r.n(s),f=r(15),p=r.n(f),l=r(22),g=r(16),O=r(29),b=r(26),S=r(1),m=r(3),w=r(34),v=r(31);function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){a()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var y=Object(v.a)("Registration"),E=function(){var t=u()(o.a.mark((function t(){var e,r,n,c,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,y("Logout started"),t.next=4,d.a.getAsyncUser();case 4:if(e=t.sent,e.isRegistered){t.next=10;break}return t.abrupt("return",e);case 10:if(!S.i){t.next=17;break}return t.next=13,p()("v1.0.0/authentication/logout",{method:"POST",headers:{"x-spot-id":S.r}});case 13:n=t.sent,r=Object(s.parseUser)(n),t.next=27;break;case 17:return t.next=19,Object(l.default)("me/logout",{method:"POST",body:JSON.stringify({spot_id:S.r})});case 19:return t.next=21,Object(O.a)();case 21:return c=t.sent,a=c.token,d.a.setToken(a),t.next=26,Object(b.a)();case 26:r=t.sent;case 27:return Object(w.b)(),d.a.set(_(_({},r),{},{isSuperAdmin:!1})),y("Logout succeed, new current user is: ",r),Object(g.trackEvent)({source:"conversation",spot_id:S.r,post_id:S.n,type:"logout-clicked",item_type:"logout",segment:"success"}),t.abrupt("return",r);case 32:t.next=40;break;case 34:return t.prev=34,t.t0=t.catch(0),m.a.error("logout",t.t0),y("Logout failed with: ",t.t0),Object(g.trackEvent)({source:"conversation",spot_id:S.r,post_id:S.n,type:"logout-clicked",item_type:"logout",segment:"error"}),t.abrupt("return",new Error("Logout failed due to with error: ".concat(t.t0)));case 40:case"end":return t.stop()}}),t,null,[[0,34]])})));return function(){return t.apply(this,arguments)}}();e.default=E}}]);
//# sourceMappingURL=registration-logout-bundle.js.map